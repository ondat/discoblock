apiVersion: kuttl.dev/v1beta1
kind: TestAssert
timeout: 360
collectors:
  - type: events
    namespace: storageos
  - type: command
    command: kubectl get po -A -o wide
  - type: command
    command: kubectl get stos -n storageos storageoscluster -o yaml
  - type: command
    command: kubectl logs -n storageos -l app.kubernetes.io/component
  - type: command
    command: kubectl get sa -n storageos -o yaml
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: cert-manager
  namespace: cert-manager
status:
  availableReplicas: 1
---
apiVersion: storageos.com/v1
kind: StorageOSCluster
metadata:
  name: storageoscluster
  namespace: storageos
spec:
  kvBackend:
    address: storageos-etcd.storageos-etcd:2379
  secretRefName: storageos-api
  storageClassName: storageos
status:
  conditions:
  - lastTransitionTime: "2023-03-17T11:23:55Z"
    message: Scheduler Ready
    reason: Ready
    status: "True"
    type: SchedulerReady
  - lastTransitionTime: "2023-03-17T11:25:06Z"
    message: Node Ready
    reason: Ready
    status: "True"
    type: NodeReady
  - lastTransitionTime: "2023-03-17T11:48:41Z"
    message: APIManager Ready
    reason: Ready
    status: "True"
    type: APIManagerReady
  - lastTransitionTime: "2023-03-17T11:49:04Z"
    message: CSI Ready
    reason: Ready
    status: "True"
    type: CSIReady
  - lastTransitionTime: "2023-03-17T11:48:29Z"
    message: CLI Ready
    reason: Ready
    status: "True"
    type: CLIReady
  - lastTransitionTime: "2023-03-17T11:49:04Z"
    message: Cluster Ready
    reason: Ready
    status: "True"
    type: Ready
  phase: Running
  ready: 1/1